<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bekhruzbek Mirzaliev - PHP Developer Portfolio</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.134.0/examples/js/controls/PointerLockControls.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            overflow: hidden;
            background: #0a0a0a;
            color: #e0e0e0;
            cursor: crosshair;
        }

        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .info-panel {
            position: absolute;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            border: 2px solid #4ecdc4;
            border-radius: 15px;
            padding: 2rem;
            max-width: 500px;
            min-width: 400px;
            opacity: 0;
            transition: opacity 0.5s ease, transform 0.5s ease;
            pointer-events: auto;
            color: #e0e0e0;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.6);
            transform: translateY(20px);
            z-index: 2;
        }

        .info-panel.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .info-panel h2 {
            color: #4ecdc4;
            font-size: 2rem;
            margin-bottom: 1.5rem;
            text-shadow: 0 0 8px rgba(78, 205, 196, 0.7);
        }

        .info-panel p, .info-panel ul {
            font-size: 1.1rem;
            line-height: 1.7;
        }

        .info-panel ul {
            list-style: disc;
            margin-left: 2rem;
        }

        .cta-button {
            background: linear-gradient(45deg, #4ecdc4, #ff6b9d);
            border: none;
            padding: 1rem 2rem;
            border-radius: 30px;
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            transition: transform 0.3s ease;
            margin-top: 1.5rem;
            display: inline-block;
            text-decoration: none;
        }

        .cta-button:hover {
            transform: scale(1.05);
        }

        #instructions {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 2rem;
            border-radius: 15px;
            font-size: 1.3rem;
            z-index: 3;
            text-align: center;
            color: #fff;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.7);
        }

        #instructions.hidden {
            display: none;
        }

        #click-message {
            position: absolute;
            top: 70%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 1rem 2rem;
            border-radius: 10px;
            font-size: 1rem;
            color: #fff;
            z-index: 3;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        #click-message.visible {
            opacity: 1;
        }

        #crosshair {
            position: fixed;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            transform: translate(-50%, -50%);
            z-index: 3;
            color: rgba(255, 255, 255, 0.5);
            font-size: 20px;
            text-align: center;
            pointer-events: none;
        }

        @media (max-width: 768px) {
            .info-panel {
                max-width: 350px;
                min-width: 300px;
                padding: 1.5rem;
            }

            .info-panel h2 {
                font-size: 1.5rem;
            }

            .info-panel p, .info-panel ul {
                font-size: 1rem;
            }

            #instructions, #click-message {
                font-size: 1rem;
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div id="canvas-container"></div>
    <div id="instructions">
        Welcome to My Portfolio!<br>
        Press <strong>W</strong> or <strong>â†‘</strong> to start your journey.<br>
        Use <strong>WASD</strong> or <strong>Arrow Keys</strong> to move, mouse to look around.<br>
        Click to lock/unlock controls.
    </div>
    <div id="click-message">Click the card to continue your journey</div>
    <div id="crosshair">+</div>

    <script>
        let scene, camera, renderer, controls, terrain, panels = [], arrows = [];
        let moveForward = false, moveBackward = false, moveLeft = false, moveRight = false;
        let hasMoved = false, currentPanelIndex = 0;
        const velocity = new THREE.Vector3();
        const direction = new THREE.Vector3();
        const clock = new THREE.Clock();

        function init() {
            // Scene setup
            scene = new THREE.Scene();
            scene.fog = new THREE.Fog(0x0a0a0a, 50, 200);

            // Camera
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 2, 0);

            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.getElementById('canvas-container').appendChild(renderer.domElement);

            // Controls
            controls = new THREE.PointerLockControls(camera, document.body);
            document.addEventListener('click', () => controls.lock());

            // Lighting
            const ambientLight = new THREE.AmbientLight(0x606060, 0.8);
            scene.add(ambientLight);
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.7);
            directionalLight.position.set(10, 20, 10);
            scene.add(directionalLight);

            // Huge lantern lamp
            const lanternGeometry = new THREE.SphereGeometry(2, 32, 32);
            const lanternMaterial = new THREE.MeshBasicMaterial({ color: 0xfff0b3, transparent: true, opacity: 0.9 });
            const lantern = new THREE.Mesh(lanternGeometry, lanternMaterial);
            lantern.position.set(0, 30, 0);
            scene.add(lantern);
            const lanternLight = new THREE.PointLight(0xfff0b3, 1, 100);
            lanternLight.position.set(0, 30, 0);
            scene.add(lanternLight);

            // Digital flat terrain
            const terrainGeometry = new THREE.PlaneGeometry(1000, 1000, 50, 50);
            const terrainMaterial = new THREE.MeshStandardMaterial({
                color: 0x1a1a2e,
                wireframe: true,
                transparent: true,
                opacity: 0.5
            });
            terrain = new THREE.Mesh(terrainGeometry, terrainMaterial);
            terrain.rotation.x = -Math.PI / 2;
            terrain.position.y = -5;
            scene.add(terrain);

            // Enhanced particles
            const particleCount = 3000;
            const particleGeometry = new THREE.BufferGeometry();
            const positions = new Float32Array(particleCount * 3);
            for (let i = 0; i < particleCount; i++) {
                positions[i * 3] = (Math.random() - 0.5) * 500;
                positions[i * 3 + 1] = Math.random() * 20;
                positions[i * 3 + 2] = (Math.random() - 0.5) * 500;
            }
            particleGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            const particleMaterial = new THREE.PointsMaterial({
                color: 0x4ecdc4,
                size: 0.3,
                transparent: true,
                opacity: 0.7
            });
            const particles = new THREE.Points(particleGeometry, particleMaterial);
            scene.add(particles);

            // Arrow geometry
            const arrowShape = new THREE.Shape();
            arrowShape.moveTo(0, 1);
            arrowShape.lineTo(-0.5, -0.5);
            arrowShape.lineTo(0, -0.3);
            arrowShape.lineTo(0.5, -0.5);
            arrowShape.lineTo(0, 1);
            const extrudeSettings = { depth: 0.2, bevelEnabled: false };
            const arrowGeometry = new THREE.ExtrudeGeometry(arrowShape, extrudeSettings);
            const arrowMaterial = new THREE.MeshBasicMaterial({ color: 0xff6b9d, transparent: true, opacity: 0.9 });

            // Portfolio panels
            const panelPositions = [
                { x: 30, z: -30, id: 'about', content: `
                    <h2>About Me</h2>
                    <p>I am Bekhruzbek Mirzaliev, a dedicated PHP Backend Developer with over 2.5 years of experience transitioning from an English teaching background. My journey combines strong communication skills with a passion for creating efficient, scalable backend systems.</p>
                    <p><strong>Contact:</strong> bekhruzbekmirzaliev744@gmail.com</p>
                    <p><strong>LinkedIn:</strong> <a href="https://www.linkedin.com/in/bekhruzbek-mirzaliev-a68849262" target="_blank" class="cta-button">View Profile</a></p>
                `},
                { x: 60, z: -50, id: 'experience1', content: `
                    <h2>Oqila (Apr 2025 - Present)</h2>
                    <p><strong>PHP Developer</strong></p>
                    <ul>
                        <li>Adapted to various frameworks (Laravel, Symfony, WordPress, Joomla) to deliver efficient solutions.</li>
                        <li>Developed a keyword rank checker, reducing SEO task time by 40%.</li>
                        <li>Modernized legacy codebases for new server environments, optimizing performance.</li>
                    </ul>
                `},
                { x: 90, z: -20, id: 'experience2', content: `
                    <h2>Lincoln Labs (Feb 2024 - Jan 2025)</h2>
                    <p><strong>Associate Software Engineer</strong></p>
                    <ul>
                        <li>Maintained systems using PHP and MySQL, resolving technical challenges.</li>
                        <li>Contributed to various projects, gaining experience in system maintenance.</li>
                    </ul>
                `},
                { x: 120, z: -50, id: 'experience3', content: `
                    <h2>Transition (Jan 2025 - Feb 2025)</h2>
                    <p><strong>PHP Developer Intern</strong></p>
                    <ul>
                        <li>Completed learning tasks with Symfony, React.js, AWS, and PostgreSQL.</li>
                        <li>Enhanced programming skills through structured assignments.</li>
                    </ul>
                `},
                { x: 150, z: -20, id: 'education', content: `
                    <h2>Education & Courses</h2>
                    <ul>
                        <li><strong>Secondary School</strong> - Completed</li>
                        <li><strong>Najot Ta'lim (2024)</strong> - Foundation Bootcamp: Basics of Programming</li>
                        <li><strong>Najot Ta'lim (2024)</strong> - Result Bootcamp: PHP Backend Development</li>
                    </ul>
                `},
                { x: 180, z: -50, id: 'skills', content: `
                    <h2>Skills</h2>
                    <ul>
                        <li>PHP, Laravel, Symfony, Yii</li>
                        <li>MySQL, PostgreSQL, SQL</li>
                        <li>REST API, Git, Linux</li>
                        <li>Apache, Nginx, Bootstrap</li>
                        <li>Languages: Uzbek (Native), English (C1), Russian (A2)</li>
                    </ul>
                `},
                { x: 210, z: -20, id: 'contact', content: `
                    <h2>Contact Me</h2>
                    <p>Let's collaborate on your next project!</p>
                    <a href="mailto:bekhruzbekmirzaliev744@gmail.com" class="cta-button">Email Me</a>
                `}
            ];

            panelPositions.forEach(pos => {
                // Create 3D billboard
                const canvas = document.createElement('canvas');
                canvas.width = 1024;
                canvas.height = 1024;
                const context = canvas.getContext('2d');
                context.fillStyle = 'rgba(0, 0, 0, 0.85)';
                context.fillRect(0, 0, canvas.width, canvas.height);
                const texture = new THREE.CanvasTexture(canvas);
                const material = new THREE.SpriteMaterial({ map: texture, transparent: true });
                const sprite = new THREE.Sprite(material);
                sprite.position.set(pos.x, 3, pos.z);
                sprite.scale.set(15, 15, 1);
                scene.add(sprite);

                // Create HTML panel
                const panel = document.createElement('div');
                panel.className = 'info-panel';
                panel.id = pos.id;
                panel.innerHTML = pos.content;
                panel.style.pointerEvents = 'auto';
                document.body.appendChild(panel);
                panels.push({ sprite, panel, position: new THREE.Vector3(pos.x, 3, pos.z) });
            });

            // Create arrows
            panels.forEach(() => {
                const arrow = new THREE.Mesh(arrowGeometry, arrowMaterial);
                arrow.position.set(0, -10, 0); // Hidden initially
                scene.add(arrow);
                arrows.push(arrow);
            });

            // Movement controls
            document.addEventListener('keydown', (e) => {
                switch (e.code) {
                    case 'ArrowUp':
                    case 'KeyW':
                        moveForward = true;
                        if (!hasMoved) {
                            hasMoved = true;
                            document.getElementById('instructions').classList.add('hidden');
                            updateArrow();
                        }
                        break;
                    case 'ArrowDown':
                    case 'KeyS':
                        moveBackward = true;
                        break;
                    case 'ArrowLeft':
                    case 'KeyA':
                        moveLeft = true;
                        break;
                    case 'ArrowRight':
                    case 'KeyD':
                        moveRight = true;
                        break;
                }
            });

            document.addEventListener('keyup', (e) => {
                switch (e.code) {
                    case 'ArrowUp':
                    case 'KeyW':
                        moveForward = false;
                        break;
                    case 'ArrowDown':
                    case 'KeyS':
                        moveBackward = false;
                        break;
                    case 'ArrowLeft':
                    case 'KeyA':
                        moveLeft = false;
                        break;
                    case 'ArrowRight':
                    case 'KeyD':
                        moveRight = false;
                        break;
                }
            });

            // Click handler for panels
            document.addEventListener('click', (e) => {
                if (currentPanelIndex >= panels.length) return;
                const panel = panels[currentPanelIndex];
                const distance = camera.position.distanceTo(panel.position);
                if (distance < 10 && e.target.closest('.info-panel')) {
                    arrows[currentPanelIndex].position.set(0, -10, 0);
                    document.getElementById('click-message').classList.remove('visible');
                    if (currentPanelIndex < panels.length - 1) {
                        currentPanelIndex++;
                        updateArrow();
                    }
                }
            });

            // Window resize
            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });

            animate();
        }

        function updateArrow() {
            if (currentPanelIndex < panels.length) {
                const arrow = arrows[currentPanelIndex];
                arrow.position.set(0, -10, 0); // Reset to update in animate
            }
        }

        function animate() {
            requestAnimationFrame(animate);
            const delta = clock.getDelta();

            // Movement
            velocity.x -= velocity.x * 10.0 * delta;
            velocity.z -= velocity.z * 10.0 * delta;
            direction.z = Number(moveForward) - Number(moveBackward);
            direction.x = Number(moveRight) - Number(moveLeft);
            direction.normalize();

            if (moveForward || moveBackward) velocity.z -= direction.z * 400.0 * delta;
            if (moveLeft || moveRight) velocity.x -= direction.x * 400.0 * delta;

            controls.moveRight(-velocity.x * delta);
            controls.moveForward(-velocity.z * delta);

            // Keep camera at fixed height
            camera.position.y = -5 + 2;

            // Update panels
            panels.forEach((p, index) => {
                const distance = camera.position.distanceTo(p.position);
                p.sprite.lookAt(camera.position);

                // Project 3D position to screen space
                const vector = p.position.clone().project(camera);
                const x = (vector.x * 0.5 + 0.5) * window.innerWidth;
                const y = (-vector.y * 0.5 + 0.5) * window.innerHeight;
                p.panel.style.left = `${x}px`;
                p.panel.style.top = `${y}px`;
                p.panel.style.transform = `translate(-50%, -50%) ${distance < 20 ? 'translateY(0)' : 'translateY(20px)'}`;
                p.panel.style.opacity = distance < 20 ? 1 : 0;
                p.panel.classList.toggle('visible', distance < 20);

                // Show click message
                const clickMessage = document.getElementById('click-message');
                if (index === currentPanelIndex && distance < 10) {
                    clickMessage.classList.add('visible');
                } else if (index === currentPanelIndex) {
                    clickMessage.classList.remove('visible');
                }
            });

            // Update arrows
            if (currentPanelIndex < panels.length) {
                const arrow = arrows[currentPanelIndex];
                const targetPos = panels[currentPanelIndex].position;
                const cameraDir = new THREE.Vector3();
                camera.getWorldDirection(cameraDir);
                const arrowPos = camera.position.clone().add(cameraDir.multiplyScalar(5));
                arrowPos.y = -5 + 3;
                arrow.position.copy(arrowPos);
                arrow.lookAt(targetPos);
                arrow.rotateX(Math.PI / 2);
                arrow.material.opacity = 0.9 + Math.sin(Date.now() * 0.003) * 0.1;
            }

            // Animate particles
            const particlePositions = scene.children.find(obj => obj.isPoints).geometry.attributes.position.array;
            for (let i = 0; i < particlePositions.length; i += 3) {
                particlePositions[i + 1] += Math.sin(Date.now() * 0.001 + i) * 0.01;
                if (particlePositions[i + 1] > 20) particlePositions[i + 1] = 0;
            }
            scene.children.find(obj => obj.isPoints).geometry.attributes.position.needsUpdate = true;

            renderer.render(scene, camera);
        }

        init();
    </script>
</body>
</html>